<!doctype html>
<html>
<head>
  <link rel="stylesheet" type="text/css" href="atom.css">
</head>
<body>

  <div id="status"></div>

  <div id="atom"></div>

  <script>
  // Best approximation of a Node built-in.
  window.setImmediate = function(callback) {
    return setTimeout(callback, 0);
  };

  function updateStatus(status) {
    document.getElementById('status').innerHTML = status;
  }
  function onAtomLoadError() {
    updateStatus('Could not load atom.js. Check your console.');
  }
  </script>
  <script src="keymap_base.js"></script>
  <script src="keymap_darwin.js"></script>
  <script src="atom.js" onerror="onAtomLoadError()"></script>

  <!-- I think this is needed for SpacePen views. -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.js"></script>

  <script>
  if (typeof Editor !== 'undefined') {
    updateStatus('Success: global Atom Editor available!');
    doStuff();
  } else {
    updateStatus('atom.js loaded, but Editor failed to load.');
  }

  function doStuff() {
    var buffer = new TextBuffer({
      filePath: '/fake/filepath.txt',
      text: 'The content of my file.',
    });
    var editor = new Editor({
      softTabs: false,
      initialLine: 1,
      initialColumn: 1,
      tabLength: 2,
      softWrap: false,
      displayBuffer: null,
      buffer: buffer,
      registerEditor: false,
      suppressCursorCreation: false,
    });

    // Look at EditorView.initialize() for an explanation of mini vs. non-mini.
    var editorView = new EditorView(editor);
    // var editorView = new EditorView({mini: true});
    editorView.setHeightInLines(4);

    var jQueryElement = $('#atom');
    // Invoking appendTo() has the side-effect of running EditorView's
    // afterAttach hook.
    editorView.appendTo(jQueryElement);
    editorView.requestDisplayUpdate();

    // This sets the default configuration, which has the side-effect of
    // enabling line numbers.
    atom.config.setDefaults('editor', EditorView.configDefaults);

    atom.keymaps.add('base', GLOBAL_KEYMAP_BASE);
    atom.keymaps.add('darwin', GLOBAL_KEYMAP_DARWIN);
  }
  </script>

</body>
</html>
